<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PowerShell - Portal Suporte Técnico</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --bg-dark: #121212;
      --bg-card: #1e1e1e;
      --text-light: #e0e0e0;
      --primary-color: #3399ff;
      --primary-hover: #1a73e8;
      --shadow-dark: rgba(0, 0, 0, 0.7);
      --transition-speed: 0.35s;
      --code-bg: #2a2a2a;
      --code-border: #444;
      --table-header-bg: #272727;
      --table-row-bg: #1f1f1f;
    }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-light);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      opacity: 0;
      animation: fadeIn var(--transition-speed) ease forwards;
      transition: background-color var(--transition-speed), color var(--transition-speed);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding-bottom: 3rem;
    }

    /* Tema claro */
    body:not(.dark) {
      background-color: #f9f9f9;
      color: #222;
    }

    @keyframes fadeIn {
      to { opacity: 1; }
    }

    header {
      position: sticky;
      top: 0;
      background-color: #1a1a1a;
      color: var(--text-light);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      box-shadow: 0 0 12px var(--shadow-dark);
      z-index: 1000;
      transition: background-color var(--transition-speed), color var(--transition-speed);
    }

    /* Header claro */
    body:not(.dark) header {
      background-color: #eee;
      color: #222;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }

    header h1 {
      margin: 0;
      font-size: 1.8rem;
      flex: 1 0 200px;
      font-weight: 700;
      user-select: none;
    }

    nav {
      flex: 2 1 500px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      align-items: center;
      user-select: none;
    }

    nav a {
      color: var(--text-light);
      text-decoration: none;
      font-weight: 600;
      padding: 0.5rem 0.9rem;
      border-radius: 6px;
      transition: background-color 0.3s, color 0.3s, transform 0.2s;
      font-size: 1rem;
    }

    /* Links claros */
    body:not(.dark) nav a {
      color: #222;
    }

    nav a:hover,
    nav a:focus {
      background-color: var(--primary-hover);
      color: white;
      transform: scale(1.05);
      box-shadow: 0 0 12px var(--primary-hover);
      outline: none;
    }

    nav a:first-child {
      font-weight: 700;
      margin-right: 2rem;
      text-decoration: underline;
    }

    button#toggle-theme {
      background: transparent;
      border: 2px solid var(--text-light);
      color: var(--text-light);
      font-weight: 700;
      padding: 0.35rem 1rem;
      cursor: pointer;
      border-radius: 6px;
      transition: background-color var(--transition-speed), color var(--transition-speed), transform 0.25s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1rem;
      user-select: none;
      flex: 0 0 auto;
      margin-left: auto;
      will-change: transform;
    }

    /* Botão claro */
    body:not(.dark) button#toggle-theme {
      border-color: #222;
      color: #222;
    }

    button#toggle-theme:hover,
    button#toggle-theme:focus {
      background-color: var(--primary-hover);
      color: white;
      transform: scale(1.1);
      box-shadow: 0 0 15px var(--primary-hover);
      outline: none;
    }

    button#toggle-theme svg {
      fill: currentColor;
      width: 20px;
      height: 20px;
      transition: transform 0.4s ease;
    }

    button#toggle-theme.dark svg {
      transform: rotate(40deg);
    }

    main {
      padding: 2rem 2rem 5rem;
      max-width: 900px;
      margin: 2rem auto;
      user-select: text;
      line-height: 1.6;
      font-size: 1rem;
      transition: color var(--transition-speed);
    }

    main h2, main h3, main h4 {
      color: var(--primary-color);
      margin-top: 2.5rem;
      margin-bottom: 1rem;
      font-weight: 700;
      user-select: text;
      scroll-margin-top: 70px;
    }

    main p {
      margin-bottom: 1rem;
      color: #ccc;
      transition: color var(--transition-speed);
    }

    /* Texto escuro para modo claro */
    body:not(.dark) main p {
      color: #333;
    }

    code, pre {
      font-family: 'Source Code Pro', monospace, monospace;
      background-color: var(--code-bg);
      border: 1px solid var(--code-border);
      border-radius: 6px;
      padding: 0.3rem 0.5rem;
      font-size: 0.95rem;
      user-select: text;
      transition: background-color var(--transition-speed), border-color var(--transition-speed);
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Código claro */
    body:not(.dark) code, 
    body:not(.dark) pre {
      background-color: #f0f0f0;
      border-color: #ccc;
      color: #222;
    }

    pre {
      padding: 1rem;
      overflow-x: auto;
      margin-bottom: 1.5rem;
      line-height: 1.4;
    }

    ul {
      padding-left: 1.3rem;
      margin-bottom: 1rem;
      color: #ddd;
      transition: color var(--transition-speed);
    }

    body:not(.dark) ul {
      color: #444;
    }

    ul li {
      margin-bottom: 0.4rem;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 2rem;
      color: #ddd;
      transition: color var(--transition-speed);
    }

    body:not(.dark) table {
      color: #444;
    }

    th, td {
      border: 1px solid var(--code-border);
      padding: 0.8rem 1rem;
      text-align: left;
      vertical-align: top;
      transition: border-color var(--transition-speed);
    }

    /* Bordas claras para modo claro */
    body:not(.dark) th, 
    body:not(.dark) td {
      border-color: #ccc;
    }

    th {
      background-color: var(--table-header-bg);
      font-weight: 700;
    }

    /* Cabeçalho claro */
    body:not(.dark) th {
      background-color: #e0e0e0;
    }

    tr:nth-child(even) {
      background-color: var(--table-row-bg);
    }

    /* Linhas claras */
    body:not(.dark) tr:nth-child(even) {
      background-color: #fafafa;
    }

    a.button-back {
      display: inline-block;
      margin-top: 3rem;
      padding: 0.7rem 1.4rem;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 700;
      user-select: none;
      transition: background-color 0.3s ease;
    }

    a.button-back:hover,
    a.button-back:focus {
      background-color: var(--primary-hover);
      outline: none;
    }

    /* Scroll suave para âncoras */
    html {
      scroll-behavior: smooth;
    }

    aside#toc {
      position: fixed;
      top: 100px;
      right: 20px;
      max-width: 240px;
      background-color: var(--bg-card);
      border-radius: 10px;
      padding: 1rem 1.2rem;
      box-shadow: 0 4px 12px var(--shadow-dark);
      user-select: none;
      font-size: 0.9rem;
      display: none;
      transition: background-color var(--transition-speed), color var(--transition-speed);
      max-height: 70vh;
      overflow-y: auto;
    }

    /* Aside claro */
    body:not(.dark) aside#toc {
      background-color: #eee;
      color: #222;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    aside#toc h4 {
      color: var(--primary-color);
      margin-top: 0;
      margin-bottom: 0.8rem;
      font-weight: 700;
      user-select: none;
    }

    aside#toc ul {
      list-style-type: none;
      padding-left: 0;
      margin: 0;
    }

    aside#toc ul li {
      margin-bottom: 0.6rem;
    }

    aside#toc ul li a {
      color: var(--text-light);
      text-decoration: none;
      transition: color 0.3s;
      user-select: text;
    }

    /* Links do aside claro */
    body:not(.dark) aside#toc ul li a {
      color: #222;
    }

    aside#toc ul li a:hover,
    aside#toc ul li a:focus {
      color: var(--primary-hover);
      outline: none;
      text-decoration: underline;
    }

    @media (min-width: 1000px) {
      aside#toc {
        display: block;
      }
      main {
        margin-right: 280px;
      }
    }

    @media (max-width: 640px) {
      main {
        padding: 1rem 1rem 4rem;
        margin: 1rem auto;
        max-width: 95%;
      }
      aside#toc {
        display: none !important;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>PowerShell - Portal Suporte Técnico</h1>
    <nav>
      <a href="index.html">Página Inicial</a>
      <a href="powershell.html" aria-current="page" style="text-decoration: underline; font-weight: 700;">PowerShell</a>
      <a href="cmd.html">CMD</a>
      <a href="redes.html">Redes</a>
      <a href="atalho.html">Atalhos</a>
      <a href="sintaxes.html">Sintaxes</a>
      <a href="executar.html">Executar</a>
      <a href="nmap.html">Nmap</a>
      <a href="linux.html">Linux</a>
      <a href="wireshark.html">Wireshark</a>
    </nav>
    <button id="toggle-theme" aria-label="Alternar tema claro/escuro" title="Alternar tema claro/escuro" type="button">
      <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <path d="M12 3v2m6.364 1.636l-1.414 1.414M21 12h-2M17.364 17.364l-1.414-1.414M12 19v2M6.636 17.364l1.414-1.414M3 12H1m4.95-4.95l1.414 1.414" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
      </svg>
      Modo Escuro
    </button>
  </header>

  <aside id="toc" aria-label="Índice do conteúdo">
    <h4>Conteúdo</h4>
    <ul>
      <li><a href="#introducao">Introdução ao PowerShell</a></li>
      <li><a href="#basico">Comandos Básicos</a></li>
      <li><a href="#variaveis">Variáveis</a></li>
      <li><a href="#controle-fluxo">Controle de Fluxo</a></li>
      <li><a href="#funcoes">Funções</a></li>
      <li><a href="#modulos">Módulos e Pacotes</a></li>
      <li><a href="#erros">Tratamento de Erros</a></li>
      <li><a href="#scripts">Scripts PowerShell</a></li>
      <li><a href="#sintaxes">Sintaxes e Flags</a></li>
      <li><a href="#exemplos">Exemplos Práticos</a></li>
      <li><a href="#suporte">Scripts para Suporte Técnico</a></li>
      <li><a href="#automatizacao">Automatização Avançada</a></li>
      <li><a href="#admin-sistema">Administração do Sistema</a></li>
      <li><a href="#manipulacao-texto">Manipulação de Texto e Arquivos</a></li>
      <li><a href="#eventos">Eventos e Logs do Sistema</a></li>
      <li><a href="#seguranca">Segurança e Permissões</a></li>
      <li><a href="#remoto">Administração Remota</a></li>
      <li><a href="#depuracao">Depuração e Logs de Scripts</a></li>
      <li><a href="#melhores-praticas">Melhores Práticas</a></li>
      <li><a href="#recursos">Recursos e Referências</a></li>
      <li><a href="#conclusao">Conclusão</a></li>
    </ul>
  </aside>

  <main>
    <section id="introducao">
      <h2>Introdução ao PowerShell</h2>
      <p>PowerShell é uma poderosa shell e linguagem de scripts desenvolvida pela Microsoft, amplamente utilizada para automação, gerenciamento e administração de sistemas Windows e também multiplataforma (Linux e Mac).</p>
      <p>Este tutorial vai guiá-lo desde conceitos básicos até comandos e scripts avançados para suportar seu dia a dia técnico.</p>
    </section>

    <section id="basico">
      <h2>Comandos Básicos do PowerShell</h2>
      <p>Comandos fundamentais para navegação, visualização e manipulação de arquivos e processos.</p>

      <table>
        <thead>
          <tr>
            <th>Comando</th>
            <th>Descrição</th>
            <th>Exemplo</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>Get-ChildItem</code> (ou <code>ls</code>)</td>
            <td>Lista arquivos e pastas no diretório atual ou especificado.</td>
            <td><pre>Get-ChildItem
ls C:\Windows</pre></td>
          </tr>
          <tr>
            <td><code>Set-Location</code> (ou <code>cd</code>)</td>
            <td>Muda o diretório atual.</td>
            <td><pre>Set-Location C:\Users
cd ..</pre></td>
          </tr>
          <tr>
            <td><code>Get-Help</code></td>
            <td>Exibe ajuda detalhada de comandos.</td>
            <td><pre>Get-Help Get-ChildItem -Full</pre></td>
          </tr>
          <tr>
            <td><code>Get-Content</code></td>
            <td>Mostra o conteúdo de arquivos texto.</td>
            <td><pre>Get-Content .\arquivo.txt</pre></td>
          </tr>
          <tr>
            <td><code>Copy-Item</code></td>
            <td>Copia arquivos ou pastas.</td>
            <td><pre>Copy-Item .\arquivo.txt D:\Backup\arquivo.txt</pre></td>
          </tr>
          <tr>
            <td><code>Move-Item</code></td>
            <td>Move arquivos ou pastas.</td>
            <td><pre>Move-Item .\arquivo.txt D:\Backup\</pre></td>
          </tr>
          <tr>
            <td><code>Remove-Item</code></td>
            <td>Remove arquivos ou pastas.</td>
            <td><pre>Remove-Item .\arquivo.txt</pre></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="variaveis">
      <h2>Variáveis</h2>
      <p>Armazenam dados para reutilização no script ou linha de comando.</p>
      <p>Exemplo de declaração e uso:</p>
      <pre><code>$nome = "Felipe"
$idade = 30
Write-Output "Nome: $nome, Idade: $idade"</code></pre>
    </section>

    <section id="controle-fluxo">
      <h2>Controle de Fluxo</h2>
      <p>Condicionais e loops para lógica dinâmica.</p>

      <h3>Condicional If</h3>
      <pre><code>if ($idade -ge 18) {
  Write-Output "Maior de idade"
} else {
  Write-Output "Menor de idade"
}</code></pre>

      <h3>Loop For</h3>
      <pre><code>for ($i=1; $i -le 5; $i++) {
  Write-Output "Número $i"
}</code></pre>

      <h3>Loop Foreach</h3>
      <pre><code>$lista = 1..5
foreach ($item in $lista) {
  Write-Output "Item: $item"
}</code></pre>

      <h3>Loop While</h3>
      <pre><code>$contador = 0
while ($contador -lt 5) {
  Write-Output "Contador: $contador"
  $contador++
}</code></pre>
    </section>

    <section id="funcoes">
      <h2>Funções</h2>
      <p>Agrupam comandos para reutilização com parâmetros.</p>
      <pre><code>function Saudacao {
  param($nome)
  Write-Output "Olá, $nome!"
}

Saudacao -nome "Felipe"</code></pre>
    </section>

    <section id="modulos">
      <h2>Módulos e Pacotes</h2>
      <p>Extensões que adicionam cmdlets e funcionalidades.</p>
      <pre><code>Install-Module -Name PowerShellGet
Import-Module -Name ActiveDirectory</code></pre>
    </section>

    <section id="erros">
      <h2>Tratamento de Erros</h2>
      <p>Captura e trata erros para scripts mais robustos.</p>
      <pre><code>try {
  Get-Item "C:\arquivo_inexistente.txt"
} catch {
  Write-Warning "Arquivo não encontrado!"
}</code></pre>
    </section>

    <section id="scripts">
      <h2>Scripts PowerShell</h2>
      <p>Salve comandos em arquivos <code>.ps1</code> para automação.</p>
      <p>Execute scripts com:</p>
      <pre><code>.\meuscript.ps1</code></pre>
      <p>Recomenda-se executar scripts assinados e manter política de execução segura.</p>
    </section>

    <section id="sintaxes">
      <h2>Sintaxes e Flags Comuns</h2>
      <table>
        <thead>
          <tr>
            <th>Flag</th>
            <th>Descrição</th>
            <th>Exemplo</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>-Verbose</code></td>
            <td>Mostra mensagens detalhadas.</td>
            <td><pre>Get-Process -Verbose</pre></td>
          </tr>
          <tr>
            <td><code>-WhatIf</code></td>
            <td>Simula a execução sem aplicar mudanças.</td>
            <td><pre>Remove-Item arquivo.txt -WhatIf</pre></td>
          </tr>
          <tr>
            <td><code>-Force</code></td>
            <td>Força a execução ignorando bloqueios.</td>
            <td><pre>Remove-Item arquivo.txt -Force</pre></td>
          </tr>
          <tr>
            <td><code>-Confirm</code></td>
            <td>Pede confirmação antes de executar.</td>
            <td><pre>Remove-Item arquivo.txt -Confirm</pre></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section id="exemplos">
      <h2>Exemplos Práticos</h2>
      <h3>Listar processos com mais de 100MB de RAM</h3>
      <pre><code>Get-Process | Where-Object { $_.WorkingSet -gt 100MB } | Sort-Object WorkingSet -Descending</code></pre>

      <h3>Backup automático de uma pasta</h3>
      <pre><code>$origem = "C:\Documentos"
$destino = "D:\Backup\Documentos_" + (Get-Date -Format yyyyMMdd)
Copy-Item -Path $origem -Destination $destino -Recurse -Force</code></pre>
    </section>

    <section id="suporte">
      <h2>Scripts para Suporte Técnico</h2>
      <h3>Verificar status do serviço Windows Update</h3>
      <pre><code>Get-Service -Name wuauserv | Select-Object Status, Name</code></pre>

      <h3>Checar espaço em disco</h3>
      <pre><code>Get-PSDrive -PSProvider FileSystem | Select-Object Name, Free, Used</code></pre>

      <h3>Reiniciar serviço de spooler de impressão</h3>
      <pre><code>Restart-Service -Name spooler</code></pre>
    </section>

    <section id="automatizacao">
      <h2>Automatização Avançada</h2>
      <p>PowerShell é ideal para automação, veja algumas técnicas e exemplos avançados.</p>

      <h3>Uso de Pipeline</h3>
      <p>Encadeie comandos para criar fluxos de dados eficientes.</p>
      <pre><code>Get-Process | Where-Object { $_.CPU -gt 100 } | Sort-Object CPU -Descending | Select-Object -First 5</code></pre>

      <h3>Filtros e Expressões Regulares</h3>
      <pre><code># Filtra arquivos com extensão .log maiores que 1MB
Get-ChildItem -Path C:\Logs -Filter *.log | Where-Object { $_.Length -gt 1MB }</code></pre>

      <h3>Trabalhando com Objetos</h3>
      <p>PowerShell manipula objetos, o que torna possível extrair propriedades e métodos facilmente.</p>
      <pre><code>$proc = Get-Process -Name "notepad"
$proc.Id
$proc.WorkingSet</code></pre>
    </section>

    <section id="admin-sistema">
      <h2>Administração do Sistema</h2>
      <p>Comandos úteis para gerenciar serviços, processos, usuários e mais.</p>

      <h3>Gerenciar Serviços</h3>
      <pre><code># Parar serviço
Stop-Service -Name "wuauserv"

# Iniciar serviço
Start-Service -Name "spooler"

# Reiniciar serviço
Restart-Service -Name "WinRM"</code></pre>

      <h3>Gerenciar Usuários Locais</h3>
      <pre><code># Listar usuários locais
Get-LocalUser

# Criar usuário
New-LocalUser -Name "usuarioTeste" -Password (ConvertTo-SecureString "Senha@123" -AsPlainText -Force) -FullName "Usuário Teste"

# Adicionar usuário a grupo
Add-LocalGroupMember -Group "Administradores" -Member "usuarioTeste"</code></pre>

      <h3>Monitorar Espaço em Disco</h3>
      <pre><code>Get-PSDrive -PSProvider FileSystem | Select-Object Name, Free, Used, @{Name='UsedGB';Expression={"{0:N2}" -f ($_.Used/1GB)}}, @{Name='FreeGB';Expression={"{0:N2}" -f ($_.Free/1GB)}}</code></pre>
    </section>

    <section id="manipulacao-texto">
      <h2>Manipulação de Texto e Arquivos</h2>
      <p>Trabalhar com strings, arquivos e relatórios é comum no suporte técnico.</p>

      <h3>Leitura e Escrita de Arquivos</h3>
      <pre><code># Ler arquivo linha a linha
Get-Content -Path "C:\Logs\log.txt"

# Escrever em arquivo (substituir conteúdo)
"Texto novo" | Out-File -FilePath "C:\Logs\log_novo.txt"

# Adicionar texto ao arquivo existente
"Nova linha" | Add-Content -Path "C:\Logs\log_novo.txt"</code></pre>

      <h3>Substituir texto usando Regex</h3>
      <pre><code>$texto = Get-Content "C:\Logs\log.txt" -Raw
$textoModificado = $texto -replace '\berro\b', 'falha'
$textoModificado | Set-Content "C:\Logs\log_corrigido.txt"</code></pre>

      <h3>Extrair dados estruturados</h3>
      <pre><code># Extrair IPs de um arquivo de log
Select-String -Path "C:\Logs\log.txt" -Pattern '\b\d{1,3}(\.\d{1,3}){3}\b' -AllMatches | ForEach-Object {
  $_.Matches | ForEach-Object { $_.Value }
} | Sort-Object -Unique</code></pre>
    </section>

    <section id="eventos">
      <h2>Eventos e Logs do Sistema</h2>
      <p>PowerShell facilita a consulta de eventos do Windows para diagnóstico.</p>

      <h3>Visualizar eventos recentes do sistema</h3>
      <pre><code>Get-EventLog -LogName System -Newest 20 | Format-Table TimeGenerated, EntryType, Source, EventID, Message -AutoSize</code></pre>

      <h3>Filtrar eventos de erro</h3>
      <pre><code>Get-EventLog -LogName Application -EntryType Error -After (Get-Date).AddDays(-7)</code></pre>

      <h3>Consultar logs com o novo cmdlet</h3>
      <pre><code>Get-WinEvent -LogName Security -MaxEvents 50 | Format-List</code></pre>
    </section>

    <section id="seguranca">
      <h2>Segurança e Permissões</h2>
      <p>Trabalhar com segurança, permissões e execuções confiáveis.</p>

      <h3>Verificar execução de scripts</h3>
      <pre><code>Get-ExecutionPolicy</code></pre>

      <h3>Alterar política de execução temporariamente</h3>
      <pre><code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process</code></pre>

      <h3>Executar script assinando digitalmente</h3>
      <pre><code>Set-AuthenticodeSignature -FilePath "C:\Scripts\meuScript.ps1" -Certificate $certificado</code></pre>

      <h3>Verificar permissões NTFS de uma pasta</h3>
      <pre><code>Get-Acl -Path "C:\Pasta" | Format-List</code></pre>
    </section>

    <section id="remoto">
      <h2>Administração Remota</h2>
      <p>Controle máquinas remotas com PowerShell Remoting e outras técnicas.</p>

      <h3>Habilitar PowerShell Remoting</h3>
      <pre><code>Enable-PSRemoting -Force</code></pre>

      <h3>Executar comando remoto</h3>
      <pre><code>Invoke-Command -ComputerName servidor01 -ScriptBlock { Get-Process }</code></pre>

      <h3>Abrir sessão remota interativa</h3>
      <pre><code>Enter-PSSession -ComputerName servidor01</code></pre>

      <h3>Copiar arquivo remotamente</h3>
      <pre><code>Copy-Item -Path "C:\local\arquivo.txt" -Destination "\\servidor01\C$\Destino" -ToSession (New-PSSession -ComputerName servidor01)</code></pre>
    </section>

    <section id="depuracao">
      <h2>Depuração e Logs de Scripts</h2>
      <p>Boas práticas para criar scripts fáceis de manter e depurar.</p>

      <h3>Habilitar modo Verbose e Debug</h3>
      <pre><code>Write-Verbose "Mensagem detalhada" -Verbose
Write-Debug "Mensagem de debug" -Debug</code></pre>

      <h3>Exemplo de função com tratamento de verbose e debug</h3>
      <pre><code>function Teste-Debug {
  [CmdletBinding()]
  param()
  
  Write-Verbose "Início da função" -Verbose
  Write-Debug "Debugando valor X" -Debug

  # Código aqui
  Write-Output "Execução normal"
}

Teste-Debug -Verbose -Debug</code></pre>

      <h3>Capturar erros para log</h3>
      <pre><code>try {
  # Código que pode falhar
} catch {
  $_ | Out-File -FilePath "C:\Logs\erros.log" -Append
}</code></pre>
    </section>

    <section id="melhores-praticas">
      <h2>Melhores Práticas para Scripts PowerShell</h2>
      <ul>
        <li>Utilize comentários explicativos para facilitar manutenção.</li>
        <li>Use funções para modularizar o código.</li>
        <li>Trate erros com blocos <code>try/catch</code>.</li>
        <li>Use parâmetros e CmdletBinding para tornar scripts reutilizáveis.</li>
        <li>Valide entradas e argumentos.</li>
        <li>Evite comandos destrutivos sem confirmação (use <code>-WhatIf</code> e <code>-Confirm</code>).</li>
        <li>Teste scripts em ambiente controlado antes de rodar em produção.</li>
      </ul>
    </section>

    <section id="recursos">
      <h2>Recursos e Referências</h2>
      <ul>
        <li><a href="https://learn.microsoft.com/pt-br/powershell/" target="_blank" rel="noopener">Documentação Oficial PowerShell</a></li>
        <li><a href="https://powershell.org" target="_blank" rel="noopener">PowerShell.org</a></li>
        <li><a href="https://github.com/PowerShell/PowerShell" target="_blank" rel="noopener">Repositório Oficial no GitHub</a></li>
        <li><a href="https://ss64.com/ps/" target="_blank" rel="noopener">Guia rápido SS64 para PowerShell</a></li>
        <li><a href="https://devblogs.microsoft.com/powershell/" target="_blank" rel="noopener">Blog oficial Microsoft PowerShell</a></li>
      </ul>
    </section>

    <section id="conclusao">
      <h2>Conclusão</h2>
      <p>Com esse guia você tem uma base sólida para usar PowerShell em suporte técnico, administração e automação. Continue praticando e explore a vasta documentação e comunidade para se tornar um expert.</p>
      <p>Se quiser aprender mais ou receber novos conteúdos, fique à vontade para acessar as outras páginas do portal!</p>
    </section>

    <a href="index.html" class="button-back" aria-label="Voltar à página inicial">Voltar ao início</a>
  </main>

  <script>
    const toggleBtn = document.getElementById('toggle-theme');
    const body = document.body;

    // Verifica tema salvo no localStorage
    const temaSalvo = localStorage.getItem('tema');
    if (temaSalvo === 'claro') {
      body.classList.remove('dark');
      toggleBtn.textContent = 'Modo Escuro';
      toggleBtn.classList.remove('dark');
    } else {
      body.classList.add('dark');
      toggleBtn.textContent = 'Modo Claro';
      toggleBtn.classList.add('dark');
    }

    toggleBtn.addEventListener('click', () => {
      body.classList.toggle('dark');
      if (body.classList.contains('dark')) {
        toggleBtn.textContent = 'Modo Claro';
        toggleBtn.classList.add('dark');
        localStorage.setItem('tema', 'escuro');
      } else {
        toggleBtn.textContent = 'Modo Escuro';
        toggleBtn.classList.remove('dark');
        localStorage.setItem('tema', 'claro');
      }
    });
  </script>
</body>
</html>
